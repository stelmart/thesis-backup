#include <iostream>
#include <math.h>
#include <gsl/gsl_spline.h>
using namespace std;

double FjCoeff(double rhoonH)
{ 
	//This function stores the values of and interpolates the complicated coefficients of Fj
  static const double Fj_a[100] = {-4.5764993060728, 1.3496371600369, 1.8373057639494, 1.9154226277516, 1.6841928525704, 1.2991747512781, 0.89231222037742, 0.54076014775226, 0.272718415784, 0.08647805584408, 
-0.03262933696907, -0.10193006898213, -0.13672214451908, -0.14889405624378, -0.14705233830081, -0.13714901739703, -0.1231567618409, -0.10763590306271, -0.092166388930077, -0.077662223572923, 
-0.06459510137829, -0.053151149700937, -0.043339350927119, -0.035065373972709, -0.028180809800088, -0.022515087373648, -0.017895335184837, -0.014158017429339, -0.011155062439133, -0.008756436492996, 
-0.0068504919235074, -0.0053430261437809, -0.0041556491513356, -0.0032238656771822, -0.0024951113510835, -0.0019268852693127, -0.0014850616307377, -0.0011423977046898, -0.00087726501014074, -0.00067256426033447, 
-0.00051484124814484, -0.00039353898160233, -0.000300412734619, -0.00022903052342704, -0.00017440229849453, -0.00013265138084362, -0.0001007893369348, -7.650018825911e-05, -5.8010700051959e-05, -4.3947270667034e-05, 
-3.3266378629549e-05, -2.5158213382004e-05, -1.9013196578266e-05, -1.4356352576184e-05, -1.0833923663745e-05, -8.1685355868279e-06, -6.156173940064e-06, -4.6353474530969e-06, -3.4892574718448e-06, -2.6238831246639e-06, 
-1.973094405916e-06, -1.4818365673408e-06, -1.1133969718413e-06, -8.3502030706619e-07, -6.2710632936503e-07, -4.6952150778434e-07, -3.5265102921179e-07, -2.6341366726746e-07, -1.9808955586953e-07, -1.4739127002228e-07, 
-1.1124841325927e-07, -8.2159970493657e-08, -6.2579250115214e-08, -4.5520347213835e-08, -3.5363872941119e-08, -2.4976921919606e-08, -2.0146467827331e-08, -1.3509861285232e-08, -1.1605805205761e-08, -7.1721656391688e-09, 
-6.7606253928432e-09, -3.7336689295842e-09, -3.9584890920708e-09, -1.9220403046916e-09, -2.3037655116909e-09, -1.0009840178959e-09, -1.2599518650625e-09, -5.4770077362321e-10, -7.0815853181472e-10, -3.4453134789558e-10, 
-3.2751856782199e-10, -2.8170660248961e-10, -6.1534111139849e-11, -3.0057761835067e-10, 1.320651921155e-10, -3.459524333671e-10, 2.5825730443074e-10, -3.724756614254e-10, 3.0937197248448e-10, -3.4596214781857e-10};
  static const double Fj_b[100] = {-1.6872803648384, -2.547057785159, -2.1337654095279, -1.5749922079161, -0.99570851761592, -0.48887774903953, -0.099671497979206, 0.16648535889026, 0.32698547436234, 0.40728785533986, 
0.43206412925879, 0.42144398751317, 0.39030676133188, 0.34893494731587, 0.30405452853302, 0.2598235145958, 0.21862697693552, 0.18166815291028, 0.14938954715712, 0.12176496263911, 
0.098497725765072, 0.079152247148355, 0.063238878498441, 0.050266476115185, 0.039772984280798, 0.031341371257785, 0.024606079652402, 0.019253582704853, 0.015019495457638, 0.01168387955957, 
0.0090657981113232, 0.0070177809210143, 0.0054205819853889, 0.0041784327211367, 0.0032148745137317, 0.0024691822297915, 0.0018933492338513, 0.0014495789522334, 0.0011082242350879, 0.00084610678090347, 
0.00064516192190445, 0.00049134792307448, 0.00037377946370959, 0.00028403592081727, 0.00021561941447673, 0.0001635235145836, 0.00012390049667327, 9.3795689268261e-05, 7.0946553841489e-05, 5.3620398846321e-05, 
4.0494969918703e-05, 3.0559810811903e-05, 2.3046380781544e-05, 1.7368297648146e-05, 1.3081020836248e-05, 9.845742961756e-06, 7.4064598004631e-06, 5.5681534363861e-06, 4.1840069267551e-06, 3.1421134583098e-06, 
2.358635672467e-06, 1.769488949116e-06, 1.3270382946684e-06, 9.9459802227475e-07, 7.4528568413945e-07, 5.5804708090634e-07, 4.1786828580692e-07, 3.1257585894617e-07, 2.3393729661758e-07, 1.7479047431657e-07, 
1.307950570073e-07, 9.7573094881565e-08, 7.3055219096396e-08, 5.4362461615609e-08, 4.0783086768803e-08, 3.0217862934112e-08, 2.2767769336518e-08, 1.6750358461382e-08, 1.2717800840223e-08, 9.256229810406e-09, 
7.1096405152016e-09, 5.1001093626102e-09, 3.9750834568419e-09, 2.8054926437537e-09, 2.2193420712302e-09, 1.5444584500202e-09, 1.2263780269084e-09, 8.5371945623969e-10, 6.8015384990794e-10, 4.7816750559093e-10, 
3.6640745992855e-10, 2.778709207174e-10, 1.8432630422005e-10, 1.7538442920184e-10, 7.6560563444517e-11, 1.2391226933417e-10, 1.4376555501627e-11, 9.5386892828841e-11, -1.6812523595533e-11, 7.342279562117e-11};
  static const double Fj_c[100] = {0.94924735335805, 0.47449630120818, 0.0055738589774864, -0.36606005000961, -0.62359581276027, -0.77221173070634, -0.8310120379759, -0.82417697096042, -0.7746570947498, -0.70107844740381, 
-0.61702653466052, -0.53159258891784, -0.45036169348466, -0.37640200555386, -0.311081837778, -0.25468250222042, -0.20683226982318, -0.1668015772913, -0.13369702380112, -0.10658410603761, 
-0.084560980216974, -0.066799288105304, -0.052563373166663, -0.041215777994791, -0.032214443990931, -0.025105271428776, -0.019512449798427, -0.015128093923487, -0.011702117905396, -0.0090328706870474, 
-0.0069587878699211, -0.0053511430053639, -0.00410787760547, -0.0031484306829368, -0.0024094601090271, -0.0018413385468133, -0.0014053086589299, -0.0010711906610862, -0.00081554680177803, -0.00062021990506467, 
-0.00047117547669401, -0.00035758832975524, -0.00027112491458842, -0.00020538140388507, -0.00015544513542665, -0.00011755332148614, -8.8828159994725e-05, -6.7071740765895e-05, -5.0607608566677e-05, -3.8158618793277e-05, 
-2.8752957141803e-05, -2.165195451917e-05, -1.629473876491e-05, -1.2255858499288e-05, -9.212889549165e-06, -6.9217030940483e-06, -5.1976105693019e-06, -3.9010038207499e-06, -2.926433559286e-06, -2.1943099003108e-06, 
-1.6446036979478e-06, -1.2320693956319e-06, -9.2262670282894e-07, -6.9062095749139e-07, -5.1675196446888e-07, -3.8650801752194e-07, -2.8898424435375e-07, -2.1599011362783e-07, -1.6137735185662e-07, -1.2053258587053e-07, 
-8.9996226887434e-08, -6.7174667883751e-08, -5.0124845801802e-08, -3.7391186147318e-08, -2.7884302020165e-08, -2.0788598634192e-08, -1.5494331484511e-08, -1.1545173872474e-08, -8.6003980187543e-09, -6.4050120068826e-09, 
-4.7689310139765e-09, -3.5498238931675e-09, -2.641814308979e-09, -1.9655456290346e-09, -1.4621149707628e-09, -1.0873528605293e-09, -8.0849513195425e-10, -6.0101586207839e-10, -4.4670299403915e-10, -3.3191920045805e-10, 
-2.4661719888464e-10, -1.8316570482568e-10, -1.3603605741874e-10, -1.0102348124708e-10, -7.4963923957228e-11, -5.5689855504859e-11, -4.1285974639038e-11, -3.0656283067643e-11, -2.2753174344636e-11, -1.6841181227356e-11};
  static const double Fj_d[100] = {0, 0.073475432381348, 0.096804121810613, 0.077861159377032, 0.027420654924662, -0.043211818674954, -0.12402259448471, -0.20722820104171, -0.2874402844011, -0.36136342071667, 
-0.42731190884781, -0.48472655035824, -0.53377329944388, -0.57504312332354, -0.60934286846201, -0.63755755929279, -0.66056472338627, -0.67918483736107, -0.69415594946416, -0.70612392276163, 
-0.71564234596257, -0.723178061828, -0.72911961931675, -0.73378690719936, -0.73744088561166, -0.74029278097774, -0.74251240949541, -0.74423548901392, -0.74556992059665, -0.74660109249505, 
-0.74739629720465, -0.74800836850245, -0.74847864801992, -0.74883938560977, -0.74911566821653, -0.74932696059364, -0.7494883295113, -0.74961141194648, -0.74970517762077, -0.74977652732361, 
-0.74983076081057, -0.74987194158027, -0.74990318047299, -0.74992685558255, -0.74994478239425, -0.74995834511595, -0.74996859786433, -0.7499763424647, -0.74998218818208, -0.74998659748809, 
-0.74998992109325, -0.74999242470565, -0.74999430946121, -0.74999572748447, -0.7499967937437, -0.74999759505637, -0.74999819693778, -0.74999864879042, -0.74999898784461, -0.74999924213715, 
-0.74999943277089, -0.749999575618, -0.74999968261189, -0.74999976271757, -0.74999982266871, -0.74999986751815, -0.74999990105801, -0.7499999261304, -0.74999994486706, -0.74999995886352, 
-0.74999996931626, -0.74999997711918, -0.74999998294308, -0.74999998728759, -0.7499999905286, -0.74999999294457, -0.74999999474623, -0.74999999608813, -0.74999999708865, -0.74999999783312, 
-0.74999999838823, -0.74999999880079, -0.7499999991085, -0.74999999933689, -0.74999999950731, -0.74999999963363, -0.74999999972793, -0.74999999979777, -0.74999999984988, -0.74999999988846, 
-0.74999999991722, -0.74999999993854, -0.74999999995436, -0.74999999996618, -0.74999999997483, -0.74999999998143, -0.74999999998611, -0.74999999998983, -0.74999999999232, -0.74999999999445};

 
  //linear interpolation test
  //int loc = int(rhoonH*100);
  //double c = (Fj_c[loc+1] - Fj_c[loc])/0.01*rhoonH + Fj_c[loc];

  int n = int(rhoonH*10.0);
  double D = rhoonH-n*0.1;
  return Fj_d[n] + D*(Fj_c[n] + D*(Fj_b[n] + D*(Fj_a[n])));
}

double rarbCoeff(double rhoonH)
{
  static const double rarb_a[100] = {-32.863426592584, 0.58901937522041, 0.39158285377872, -0.1446904097486, -0.65128968670103, -0.88182781814358, -0.81759343265431, -0.5775344212659, -0.29539757184904, -0.05637730176844, 
0.10820027193478, 0.20141599415829, 0.24057168448395, 0.24463746075343, 0.22887665745773, 0.20375501027828, 0.17568878129218, 0.14823826757481, 0.12315635748905, 0.10113872766711, 
0.082303536080758, 0.066476649860632, 0.053352777285709, 0.042582953476861, 0.033820239637373, 0.026742310158034, 0.021061373650588, 0.016527188780896, 0.012926326960916, 0.010079485416043, 
0.0078378682126401, 0.0060792665934895, 0.00470418744154, 0.0036322475683082, 0.002798934166981, 0.0021527715700243, 0.001652901361443, 0.0012670364427703, 0.00096977338269745, 0.00074119100889614, 
0.00056572785239739, 0.0004312547733143, 0.00032835510672125, 0.00024972401979628, 0.00018972177144861, 0.00014398846772679, 0.00010917649310716, 8.27030271211e-05, 6.2596713901187e-05, 4.7336924235975e-05, 
3.5771083517489e-05, 2.7008526376493e-05, 2.0379736026532e-05, 1.536536498592e-05, 1.1578804193224e-05, 8.7182525310149e-06, 6.5618219136089e-06, 4.9345901920184e-06, 3.7100116923039e-06, 2.7866530277754e-06, 
2.0931089778076e-06, 1.5703147254742e-06, 1.1786047443563e-06, 8.8308461654309e-07, 6.6251905073145e-07, 4.9560375803282e-07, 3.7183762735538e-07, 2.7756771048271e-07, 2.0852026216822e-07, 1.5505758066414e-07, 
1.1690233225892e-07, 8.6329476900461e-08, 6.5617744571257e-08, 4.7820838955382e-08, 3.7034372790679e-08, 2.6158780697117e-08, 2.1082535717199e-08, 1.4159670658209e-08, 1.2065970445008e-08, 7.5765838047915e-09, 
6.9643957267829e-09, 3.9784370242657e-09, 4.0739744910923e-09, 1.990407838548e-09, 2.5088708888177e-09, 8.6396167997549e-10, 1.4707929318902e-09, 5.539041447733e-10, 5.2757520574432e-10, 7.4925066151366e-10, 
-8.0352391407246e-11, 5.0678072849308e-10, 2.230216011867e-10, -2.3587243269674e-10, 6.4894201123877e-10, -3.3923974740446e-10, -3.5069169790347e-11, 8.571587883921e-10, -1.4261897218759e-09, 1.7019163855991e-09};
  static const double rarb_b[100] = {6.6149272145052, 0.079249373689788, 0.26584153662988, 0.38644827967241, 0.33912553064974, 0.13726503370312, -0.13224194994244, -0.37958014464274, -0.55260768892352, -0.63988060703299, 
-0.65525029242335, -0.6215130047328, -0.56020496137589, -0.4875022669482, -0.41383629711085, -0.34506308416404, -0.28392173521886, -0.23125002918596, -0.18683573286704, -0.14995278836428, 
-0.1196737911632, -0.095040126404122, -0.075147756126736, -0.059185472290756, -0.046447388361458, -0.036331996572375, -0.028334600831236, -0.0220368567188, -0.017095453065844, -0.013231041320916, 
-0.010217986683599, -0.0078752141702371, -0.0060582361655653, -0.0046523442125218, -0.0035668841065345, -0.0027305029220071, -0.0020872459879534, -0.0015933788901346, -0.0012148227003306, -0.00092509435498822, 
-0.00070366687161816, -0.00053466528304236, -0.00040584035301938, -0.00030775738092959, -0.0002331649607934, -0.00017649706510858, -0.00013349060773049, -0.00010088276607756, -7.6182496633326e-05, -5.7487735386497e-05, 
-4.3350739896697e-05, -3.2668115361179e-05, -2.4602511284888e-05, -1.8516624558651e-05, -1.3928243928762e-05, -1.0470683735053e-05, -7.8673561609843e-06, -5.9079992731359e-06, -4.4345589228501e-06, -3.3267935731218e-06, 
-2.4947427884614e-06, -1.8697836060011e-06, -1.4009303495044e-06, -1.0490317353673e-06, -7.853785694012e-07, -5.8757251675257e-07, -4.396046621169e-07, -3.2858292781102e-07, -2.4572272966372e-07, -1.8346264230029e-07, 
-1.3717917801692e-07, -1.0227288016473e-07, -7.650826194805e-08, -5.6912612678151e-08, -4.2656402854391e-08, -3.1588310855923e-08, -2.3785409197785e-08, -1.7493750614772e-08, -1.3261498288397e-08, -9.6652844061573e-09, 
-7.3972147851542e-09, -5.3256965504289e-09, -4.130342179387e-09, -2.9179553218128e-09, -2.3256047088083e-09, -1.5779580420094e-09, -1.2988460307284e-09, -8.8501345141268e-10, -6.7398642222827e-10, -5.5517035413288e-10, 
-3.1757096952134e-10, -3.1979890957601e-10, -2.1464191535259e-10, -1.001401739309e-10, -1.9704488041228e-10, -2.3075708011078e-11, -5.0520143624056e-11, -1.6931345214743e-10, 1.8415463598487e-10, -2.7889607290277e-10};
  static const double rarb_c[100] = {0.66858061872394, 1.0056632638475, 1.039183719842, 1.1040995127814, 1.1770484564234, 1.2253348719523, 1.2263330441486, 1.1753568511805, 1.082114789614, 0.9627313246738, 
0.83306388421415, 0.70525983388753, 0.58699971276571, 0.48217587102505, 0.39201454145802, 0.31611358175957, 0.25321361523511, 0.20169993163011, 0.15989707382017, 0.12622461797142, 
0.099268222128577, 0.077802569978365, 0.06078884419336, 0.047359876286575, 0.036800270432747, 0.028525399949568, 0.022061269939825, 0.017026190983114, 0.01311463530278, 0.010083334498421, 
0.0077395107967371, 0.0059310495063876, 0.0045383846701448, 0.0034678630602868, 0.0026463616448317, 0.0020169528485165, 0.0015354354112158, 0.0011675732544773, 0.0008869085697335, 0.00067303723115719, 
0.00051025409041755, 0.00038649255167472, 0.00029249713824792, 0.00022117972085456, 0.00016711996527141, 0.00012617862625175, 9.5198867261836e-05, 7.1776040513394e-05, 5.4080578111515e-05, 4.0721980197445e-05, 
3.0644540842784e-05, 2.3047525364528e-05, 1.7324158083587e-05, 1.3015047911846e-05, 9.7726839541346e-06, 7.3343992897379e-06, 5.5018101275395e-06, 4.1251935438691e-06, 3.0916313950025e-06, 2.3160199700833e-06, 
1.7342608329696e-06, 1.2981055490524e-06, 9.712582784982e-07, 7.2643033316444e-07, 5.4311654235084e-07, 4.0591639999255e-07, 3.0327000494212e-07, 2.2650419689851e-07, 1.6911463376901e-07, 1.2622570458309e-07, 
9.4184899102068e-08, 7.0256142348235e-08, 5.2391437299626e-08, 3.9058317247154e-08, 2.9110437643753e-08, 2.1690183815704e-08, 1.6157276183648e-08, 1.2032674856499e-08, 8.958714853291e-09, 6.6683987498539e-09, 
4.9626393827662e-09, 3.6921238566467e-09, 2.746342098181e-09, 2.0424928970364e-09, 1.5186051860461e-09, 1.1287459300569e-09, 8.3907317205423e-10, 6.2344107654155e-10, 4.6305106971012e-10, 3.440766005447e-10, 
2.5552449045563e-10, 1.8960416570124e-10, 1.4084336474873e-10, 1.0459674792962e-10, 7.7505862838834e-11, 5.7551824417246e-11, 4.277725396129e-11, 3.1621150142769e-11, 2.3464341580848e-11, 1.7514018013642e-11};
  static const double rarb_d[100] = {0, 0.10014390742486, 0.20209174692172, 0.309060117126, 0.42318986079112, 0.54363467205325, 0.66665898176737, 0.78715227325015, 0.90031462250051, 1.0027046270008, 
1.0925225760961, 1.1693846618652, 1.2338969312008, 1.2872354245481, 1.3308226264419, 1.366114594274, 1.3944790766186, 1.4171369095712, 1.43514264071, 1.4493871471208, 
1.460611219762, 1.4694236075993, 1.4763199399829, 1.4817006996183, 1.4858874154775, 1.4891367888768, 1.4916527512162, 1.4935965935755, 1.4950953712954, 1.496248806622, 
1.4971349091441, 1.4978145182251, 1.4983349503006, 1.4987329105934, 1.4990368057049, 1.4992685719625, 1.4994451149897, 1.4995794389723, 1.4996815295453, 1.4997590419486, 
1.4998178359192, 1.4998623903874, 1.4998961242445, 1.4999216439099, 1.4999409340322, 1.4999555041009, 1.4999665009813, 1.4999747951385, 1.4999810466179, 1.4999857554474, 
1.499989300105, 1.4999919668228, 1.4999939719027, 1.4999954786731, 1.4999966103771, 1.4999974599418, 1.4999980973932, 1.4999985754624, 1.4999989338364, 1.4999992023639, 
1.4999994034847, 1.4999995540564, 1.4999996667395, 1.4999997510346, 1.4999998140704, 1.4999998611908, 1.4999998964023, 1.4999999227051, 1.4999999423472, 1.49999995701, 
1.499999967953, 1.4999999761166, 1.4999999822058, 1.4999999867455, 1.49999999013, 1.4999999926515, 1.4999999945308, 1.4999999959298, 1.4999999969723, 1.4999999977476, 
1.4999999983254, 1.4999999987546, 1.4999999990746, 1.499999999312, 1.499999999489, 1.4999999996201, 1.4999999997181, 1.4999999997905, 1.4999999998445, 1.4999999998846, 
1.4999999999142, 1.4999999999365, 1.4999999999528, 1.499999999965, 1.4999999999742, 1.4999999999806, 1.4999999999858, 1.4999999999895, 1.4999999999919, 1.4999999999946};

    //linear interpolation test
  //int loc = int(rhoonH*100);
  //double c = (rarb_c[loc+1] - rarb_c[loc])/0.01*rhoonH + rarb_c[loc];
  int n = int(rhoonH*10.0);
  double D = rhoonH-n*0.1;
  return rarb_d[n] + D*(rarb_c[n] + D*(rarb_b[n] + D*(rarb_a[n])));
}
